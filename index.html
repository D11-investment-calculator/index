<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Read CSV File</title>
  
</head>
<body>
<h1 style="text-align: center;background-color: black;color: white;">Welcome to Dream11 Investment Calculator</h1>
<div style="text-align: center;font-size: x-large;font-weight: bold;">
   <label>
      Please upload your CSV file here!
   </label><br>
<input type="file" id="fileInput" style="background-color: rgb(0, 0, 0); color: white;font-size: medium;" />
</div>
<br>
<br>
<div id = "result" style ="font-size: x-large;padding-left: 20%;">
<table  border="1" style="border: 2px solid black;width: 70%; border-radius: 10px; border-collapse: collapse;border-color: white;">
   <tr>
      <th style="background-color: rgb(82, 226, 113);">
         Deposited Cash: 
      </th>
      <td  style="background-color: rgb(0, 0, 0);width: 30%;color: white;">
         <span id="Deposited" >0</span>
      </td>
      </tr>
      <tr>
         <th style="background-color: rgb(81, 105, 211);">
            Withdrew Cash: 
         </th>
         <td  style="background-color: rgb(0, 0, 0);width: 30%;color: white;">
            <span id="withdrew">0</span> 
         </td>
      </tr>
     <tr>
      <th style="background-color: rgb(191, 211, 81);">
         Total Contests Joined:
      </th>
      <td  style="background-color: rgb(0, 0, 0);width: 30%;color: white;">
         <span id="Joined">0</span>
      </td>
     </tr>
     <tr>
      <th style="background-color: rgb(191, 211, 81);">
         Win %:
      </th>
      <td  style="background-color: rgb(0, 0, 0);width: 30%;color: white;">
         <span id="Win">0 </span><span>%</span>
      </td>
     </tr>
     <tr>
      <th style="background-color: rgb(191, 211, 81);">
         Total <span id="lossitem">Loss</span>:
      </th>
      <td  style="background-color: rgb(0, 0, 0);width: 30%;color: white;">
         <span id="Loss">0</span>
      </td>
     </tr>
</table>
</div>
 <script>
   document.getElementById('fileInput').addEventListener('change', handleFile);
 
 function handleFile(event) {
   const fileInput = event.target;
   const file = fileInput.files[0];
 
   if (!file) {
     console.error('No file selected');
     return;
   }
 
   if (!file.name.endsWith('.csv')) {
     console.error('Selected file is not a CSV file');
     return;
   }
 
   const reader = new FileReader();
 
   reader.onload = function(e) {
     const contents = e.target.result;
     processCSV(contents);
   };
 
   reader.readAsText(file);
 }
 
 function processCSV(contents) {
    var count = 0;
    var sum = 0;
    var sumW = 0;
    var countW = 0;
    var countJ = 0;
    var countC = 0;
   // Split the CSV content into rows
   const rows = contents.split('\n');
   //console.log(rows);
   // Process each row
   for (let i = 0; i < rows.length; i++) {
     // Split the row into columns
     const columns = rows[i].split(',');
     //console.log(columns);
     if(columns[5]=='"Deposited Cash"')
     {
       sum = sum + parseFloat(columns[4]);
       count = count + 1;
     }
     if(columns[5]=='"Withdrew Cash"')
     {
       sumW = sumW + parseFloat(columns[4]);
       countW = countW + 1;
     }
     if(columns[5]=='"Joined A Contest"')
     {
       countJ = countJ + 1;
     }
     if(columns[5]=='"Won A Contest"')
     {
       countC = countC + 1;
     }
   }
 let loss = parseFloat(sum-sumW).toFixed(2);
 if(loss <= 0)
 {
 document.getElementById('lossitem').innerText = 'Profit';
 loss = loss.slice(1);
 }
   console.log("deposited cash:"+ sum);
   console.log("deposited cash count :" +count);
   console.log("withdrew cash count"+ countW );
   console.log("withdrew cash "+ sumW);
   console.log("Joined contests"+ countJ );
   console.log("Won A Contest"+ countC );
   console.log("Won A Contest %"+ parseFloat(countC*100/countJ).toFixed(2));
  let won_percentage = parseFloat(countC*100/countJ).toFixed(2);
   document.getElementById("Deposited").innerHTML = sum;
   document.getElementById("withdrew").innerHTML = sumW;
   document.getElementById("Joined").innerHTML = countJ;
   document.getElementById("Loss").innerHTML = loss;
   document.getElementById("Win").innerHTML = won_percentage;
 }
 
 </script>
</body>
</html>